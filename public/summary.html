<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Summary of Claims</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
    integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7"
    crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css"
    integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r"
    crossorigin="anonymous">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="page-header">
        <h1 id="header"></h1>
      </div>
      <table id="table"></table>
    </div>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.10.1/bootstrap-table.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"
    integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS"
    crossorigin="anonymous"></script>

    <script>

    $(document).ready(function () {
      // Call globalization pipeline and load strings
      var instance = "2db863ea6d4653074ca538dc8ef6c0d6";
      var username = "7aeb978446ec9a0e5918b3d746f458ec";
      var password = "i361I9qLOlRZQ7/8n0Z8hY5Czqqf8fZn";
      var base = "https://gp-rest.ng.bluemix.net/translate/rest/";
      var language = navigator.language.substring(0,2);
      var urlPipeline = base + instance + "/v2/bundles/" + "summary/" + language;

      $.ajax({
        type: "GET",
        url: urlPipeline,
        beforeSend: function (xhr) {
          xhr.setRequestHeader ("Authorization", "Basic " + btoa(username + ":" + password));
        },
        success: function(data) {
            $("#header").text(data.resourceStrings.summary);

            // Create the Bootstrap table
            var clientId = '520dd2ab-feef-41cb-9831-ce69e653af95';
            var urlData = 'https://api.us.apiconnect.ibmcloud.com/atkinusibmcom-dev/production/v1/claims?client_id=' + clientId;
            $('#table').bootstrapTable({
                method: 'get',
                url: urlData,
                showColumns: true,
                height: 400,
                columns: [
                  {
                    field: 'state',
                    title: data.resourceStrings.state,
                    sortable: true
                  },
                  {
                    field: 'claimType',
                    title: data.resourceStrings.claimType,
                    sortable: true
                  },
                  {
                    field: 'coverageType',
                    title: data.resourceStrings.coverageType,
                    sortable: true
                  },
                  {
                    field: 'numberOfClaims',
                    title: data.resourceStrings.claimsNumber,
                    sortable: true
                  },
                  {
                    field: 'totalClaimsAmount',
                    title: data.resourceStrings.claimsTotal,
                    sortable: true
                  }
                ]
            });
        },
        error: function(xhr) {
            alert(xhr.status);
        }
      });
    });
    </script>
  </body>
</html>
